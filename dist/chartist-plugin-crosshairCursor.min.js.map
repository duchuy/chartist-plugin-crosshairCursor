{"version":3,"sources":["chartist-plugin-crosshairCursor.js"],"names":["root","factory","define","amd","Chartist","returnExportsGlobal","exports","module","require","this","window","document","plugins","crosshairCursor","options","CrosshairCursor","chart","_chart","frozen","_pointArea","calculatePointArea","sendMetaData","freezeChange","currentPoints","createCrosshairCursor","destroyCrosshairCursor","styleCrosshairCursor","unwrapChart","showCrosshairCursor","moveCrosshairCursor","highlightCurrentPoints","clickFn","hideCrosshairCursor","dataPoints","noop","defaultOptions","wrapChart","chartWrapper","createElement","className","container","parentNode","insertBefore","appendChild","style","cursor","position","x","y","click","hover","styles","backgroundColor","width","height","extend","prototype","_chartWrapper","create","_crosshairCursor","hide","addEventListener","bind","move","show","destroy","reset","e","call","highlightedPoints","freeze","unfreeze","isFrozen","element","points","meta","map","point","eventEmitter","emit","filter","current","type","div","firstChild","querySelector","remove","Object","keys","forEach","property","inPointArea","cursorPosition","pointPosition","padding","formatPointData","deserialize","value","axisX","ticks","index","Math","round","toggleHighlight","highlight","addClass","removeClass","cursorIsOnPoint","outerHTML","innerHTML","ctPoints","querySelectorAll","getComputedStyle","replace","display","crosshairCursorPosition","pageX","offsetLeft","pageY","offsetTop","left","top","pointArea","highlighted","stopPropagation","created","Line","on","data","push"],"mappings":";;;;;;CAAC,SAAUA,EAAMC,GACO,kBAAXC,SAAyBA,OAAOC,IAEzCD,QAAQ,YAAa,SAAUE,GAC7B,MAAQJ,GAAKK,oBAAsBJ,EAAQG,KAEjB,gBAAZE,SAIhBC,OAAOD,QAAUL,EAAQO,QAAQ,aAEjCR,EAAK,oCAAsCC,EAAQG,WAErDK,KAAM,SAAUL,GAmShB,MA5RC,UAASM,EAAQC,EAAUP,GAC1B,YAEAA,GAASQ,QAAUR,EAASQ,YAE5BR,EAASQ,QAAQC,gBAAkB,SAASC,GAuC1C,QAASC,GAAgBC,GACvBP,KAAKQ,OAASD,EACdP,KAAKS,QAAS,EACdT,KAAKU,WAAaC,IAzCpB,GAIIC,GAAcC,EAAcC,EAAeC,EAAuBC,EAAwBC,EAAsBC,EAAaP,EAAoBQ,EAAqBC,EAAqBC,EAAwBC,EAASC,EAJ5NC,KACAC,EAAO,aAKPC,GACFC,UAAW,SAASpB,GAClB,GAAIqB,GAAe1B,EAAS2B,cAAc,MAO1C,OANAD,GAAaE,UAAY,0BACzBvB,EAAMwB,UAAUC,WAAWC,aAAaL,EAAcrB,EAAMwB,WAC5DH,EAAaM,YAAY3B,EAAMwB,WAC/BH,EAAaO,MAAMC,OAAS,UAC5BR,EAAaO,MAAME,SAAW,WAEvBT,GAETU,GAAG,EACHC,GAAG,EACHC,MAAOf,EACPgB,MAAOhB,EACPZ,aAAcY,EACdiB,QACEJ,GACEK,gBAAiB,UACjBC,MAAO,MACPC,OAAQ,OAEVN,GACEI,gBAAiB,UACjBC,MAAO,OACPC,OAAQ,QAKdxC,GAAUV,EAASmD,UAAWpB,EAAgBrB,GAQ9CC,EAAgByC,UAAUpB,UAAY,WACpC,GAAG3B,KAAKgD,cAAiB,MAAOhD,MAAKgD,aAErChD,MAAKgD,cAAgB3C,EAAQsB,UAAU3B,KAAKQ,SAG9CF,EAAgByC,UAAUE,OAAS,WACjCjD,KAAK2B,YAEL3B,KAAKkD,oBACLlD,KAAKkD,iBAAiBZ,EAAIvB,EAAsBf,KAAKgD,cAAe,KACpEhD,KAAKkD,iBAAiBX,EAAIxB,EAAsBf,KAAKgD,cAAe,KACpEhD,KAAKmD,KAAKnD,KAAKkD,kBAEflD,KAAKgD,cAAcI,iBAAiB,QAAS9B,EAAQ+B,KAAKrD,OAC1DA,KAAKgD,cAAcI,iBAAiB,YAAapD,KAAKsD,KAAKD,KAAKrD,OAChEA,KAAKgD,cAAcI,iBAAiB,aAAcpD,KAAKuD,KAAKF,KAAKrD,OACjEA,KAAKgD,cAAcI,iBAAiB,aAAcpD,KAAKmD,KAAKE,KAAKrD,QAGnEM,EAAgByC,UAAUS,QAAU,WAClCxC,EAAuBhB,KAAKkD,kBAE5BhC,EAAYlB,KAAKgD,gBAGnB1C,EAAgByC,UAAUQ,KAAO,WAC/BpC,EAAoBnB,KAAKkD,mBAG3B5C,EAAgByC,UAAUI,KAAO,WAC3BnD,KAAKS,QACPc,EAAoBvB,KAAKkD,mBAI7B5C,EAAgByC,UAAUU,MAAQ,WAChCzD,KAAKS,QAAS,EACdT,KAAKmD,QAGP7C,EAAgByC,UAAUO,KAAO,SAASI,GACxC,IAAI1D,KAAKS,OAAO,CACd,GAAI4B,GAAWjB,EAAoBuC,KAAK3D,KAAKgD,cAAeU,EAAG1D,KAAKkD,kBAChEU,EAAoBvC,EAAuBgB,EAAUrC,KAAKU,WAC9DE,GAAa+C,KAAK3D,KAAM4D,KAI5BtD,EAAgByC,UAAUc,OAAS,WACjC7D,KAAKS,QAAS,EACdI,EAAa8C,KAAK3D,OAGpBM,EAAgByC,UAAUe,SAAW,WACnC9D,KAAKS,QAAS,EACdI,EAAa8C,KAAK3D,OAGpBM,EAAgByC,UAAUgB,SAAW,WACnC,MAAO/D,MAAKS,QAGdH,EAAgByC,UAAUjC,cAAgB,WACxC,MAAOA,MAGTR,EAAgByC,UAAUiB,QAAU,WAClC,MAAOhE,MAAKgD,eAGdpC,EAAe,SAASqD,GACtB,GAAIC,GAAOD,EAAOE,IAAI,SAASC,GAC7B,MAAOA,GAAMF,MAEf7D,GAAQoC,MAAMzC,KAAMkE,GACpBlE,KAAKQ,OAAO6D,aAAaC,KAAK,0BAA2BJ,IAG3DrD,EAAe,WACbR,EAAQQ,aAAab,KAAKS,QAC1BT,KAAKQ,OAAO6D,aAAaC,KAAK,yBAA0BtE,KAAKS,SAG/DK,EAAgB,WACd,MAAOU,GAAW+C,OAAO,SAASH,GAChC,MAAOA,GAAMI,WAIjBzD,EAAwB,SAASa,EAAc6C,GAC7C,GAAIC,GAAMxE,EAAS2B,cAAc,MACjC6C,GAAI5C,UAAY,mBAAqB2C,EACrC7C,EAAaK,aAAayC,EAAK9C,EAAa+C,WAC5C,IAAIvE,GAAkBwB,EAAagD,cAAc,oBAAsBH,EAKvE,OAJArE,GAAgB+B,MAAME,SAAW,WAEjCpB,EAAqBb,EAAiBqE,GAE/BrE,GAGTY,EAAyB,SAASZ,GAChCA,EAAgBkC,EAAEuC,SAClBzE,EAAgBmC,EAAEsC,UAGpB5D,EAAuB,SAASb,EAAiBqE,GAC/C,GAAI/B,GAASrC,EAAQqC,OAAO+B,EAC5BK,QAAOC,KAAKrC,GAAQsC,QAAQ,SAASC,GACnC7E,EAAgB+B,MAAM8C,GAAYvC,EAAOuC,KAI7C,IAAIC,GAAc,SAASC,EAAgBC,EAAeC,GACxD,MAAQF,IAAmBC,EAAgBC,GAAYF,GAAmBC,EAAgBC,GAGxFC,EAAkB,SAASlB,GAC7B,GAAIF,GAAOvE,EAAS4F,YAAYnB,EAAMF,KAGtC,OAFAA,GAAKsB,MAAQpB,EAAMoB,MACnBtB,EAAKsB,MAAMlD,EAAI8B,EAAMqB,MAAMC,MAAMtB,EAAMuB,QAErCzB,KAAMA,EACN7B,UAAWC,EAAGsD,KAAKC,MAAMzB,EAAM9B,GAAIC,EAAGqD,KAAKC,MAAMzB,EAAM7B,IACvDyB,QAASI,EAAMJ,UAIf8B,EAAkB,SAAS1B,EAAO2B,GACjCA,EACD3B,EAAMJ,QAAQgC,SAAS,6BAEvB5B,EAAMJ,QAAQiC,YAAY,8BAI1BC,EAAkB,SAASf,EAAgBC,EAAeC,GAC5D,MAAGhF,GAAQiC,GAAKjC,EAAQkC,EACf2C,EAAYC,EAAe7C,EAAG8C,EAAc9C,EAAG+C,IAAYH,EAAYC,EAAe5C,EAAG6C,EAAc7C,EAAG8C,GACzGhF,EAAQiC,EACT4C,EAAYC,EAAe7C,EAAG8C,EAAc9C,EAAG+C,GAC9ChF,EAAQkC,EACT2C,EAAYC,EAAe5C,EAAG6C,EAAc7C,EAAG8C,OADjD,GA6DT,OAxDAnE,GAAc,SAASU,GACrBA,EAAauE,UAAYvE,EAAawE,WAGxCzF,EAAqB,WACnB,GAAI0F,GAAWnG,EAASoG,iBAAiB,YAEzC,QADiBrG,EAAOsG,iBAAiBF,EAAS,IAAI,gBAAgBG,QAAQ,KAAM,IACjE,GAGrBrF,EAAsB,SAASf,GAC1BC,EAAQiC,GAAKjC,EAAQkC,GACtBnC,EAAgBkC,EAAEH,MAAMsE,QAAU,GAClCrG,EAAgBmC,EAAEJ,MAAMsE,QAAU,IAC1BpG,EAAQiC,EAChBlC,EAAgBkC,EAAEH,MAAMsE,QAAU,GAC1BpG,EAAQkC,IAChBnC,EAAgBmC,EAAEJ,MAAMsE,QAAU,KAItCrF,EAAsB,SAASsC,EAAGtD,GAChC,GAAIsG,KAQJ,OANAA,GAAwBpE,EAAIoB,EAAEiD,MAAQ3G,KAAK4G,WAC3CF,EAAwBnE,EAAImB,EAAEmD,MAAQ7G,KAAK8G,UAE3C1G,EAAgBkC,EAAEH,MAAM4E,KAAOL,EAAwBpE,EAAI,KAC3DlC,EAAgBmC,EAAEJ,MAAM6E,IAAMN,EAAwBnE,EAAI,KAEnDmE,GAGTrF,EAAyB,SAASqF,EAAyBO,GACzD,MAAOzF,GAAW+C,OAAO,SAASH,GAChC,GAAI8C,GAAchB,EAAgBQ,EAAyBtC,EAAM/B,SAAU4E,EAG3E,OAFAnB,GAAgB1B,EAAO8C,GACvB9C,EAAMI,QAAU0C,EACTA,KAIX5F,EAAU,SAASoC,GACjBA,EAAEyD,iBACF,IAAIjD,GAAOpD,IAAgBqD,IAAI,SAASC,GACtC,MAAOA,GAAMF,MAEf7D,GAAQmC,MAAMxC,KAAMkE,GACpBlE,KAAKQ,OAAO6D,aAAaC,KAAK,wBAAyBJ,IAGzD3C,EAAsB,SAASnB,GAC7BA,EAAgBkC,EAAEH,MAAMsE,QAAU,OAClCrG,EAAgBmC,EAAEJ,MAAMsE,QAAU,QAG7B,SAAyBlG,GAC9B,GAAI6G,IAAU,CAEd,MAAG7G,YAAiBZ,GAAS0H,MAoB3B,KAAM,4CAlBN9G,GAAM+G,GAAG,OAAQ,SAASC,GACP,UAAdA,EAAK9C,OACY,IAAf8C,EAAK5B,QAAenE,MACvBA,EAAWgG,KAAKlC,EAAgBiC,OAIpChH,EAAM+G,GAAG,UAAW,WACdF,EAKF7G,EAAMH,gBAAgBqD,SAJtB2D,GAAU,EACV7G,EAAMH,gBAAkB,GAAIE,GAAgBC,GAC5CA,EAAMH,gBAAgB6C,eAchChD,OAAQC,SAAUP,GACbA,EAASQ,QAAQC","file":"chartist-plugin-crosshairCursor.min.js","sourcesContent":["(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([\"chartist\"], function (Chartist) {\n      return (root.returnExportsGlobal = factory(Chartist));\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like enviroments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"chartist\"));\n  } else {\n    root['Chartist.plugins.crosshairCursor'] = factory(Chartist);\n  }\n}(this, function (Chartist) {\n\n  /**\n   * Chartist.js plugin that generates a crosshair cursor for a line chart which highlights and notifies you of any data points that fall along the crosshair axis\n   *\n   */\n  /* global Chartist */\n  (function(window, document, Chartist) {\n    'use strict';\n\n    Chartist.plugins = Chartist.plugins || {};\n\n    Chartist.plugins.crosshairCursor = function(options) {\n      var dataPoints = [];\n      var noop = function() {};\n\n      //private methods\n      var sendMetaData, freezeChange, currentPoints, createCrosshairCursor, destroyCrosshairCursor, styleCrosshairCursor, unwrapChart, calculatePointArea, showCrosshairCursor, moveCrosshairCursor, highlightCurrentPoints, clickFn, hideCrosshairCursor;\n\n      var defaultOptions = {\n        wrapChart: function(chart) {\n          var chartWrapper = document.createElement('div');\n          chartWrapper.className = 'crosshairCursor-wrapper';\n          chart.container.parentNode.insertBefore(chartWrapper, chart.container);\n          chartWrapper.appendChild(chart.container);\n          chartWrapper.style.cursor = 'pointer';\n          chartWrapper.style.position = 'relative';\n\n          return chartWrapper;\n        },\n        x: true,\n        y: true,\n        click: noop,\n        hover: noop,\n        freezeChange: noop,\n        styles: {\n          x: {\n            backgroundColor: '#dedede',\n            width: '1px',\n            height: '95%'\n          },\n          y: {\n            backgroundColor: '#dedede',\n            width: '100%',\n            height: '1px'\n          }\n        }\n      };\n\n      options = Chartist.extend({}, defaultOptions, options);\n\n      function CrosshairCursor(chart) {\n        this._chart = chart;\n        this.frozen = false;\n        this._pointArea = calculatePointArea();\n      }\n\n      CrosshairCursor.prototype.wrapChart = function() {\n        if(this._chartWrapper) { return this._chartWrapper; }\n\n        this._chartWrapper = options.wrapChart(this._chart);\n      };\n\n      CrosshairCursor.prototype.create = function() {\n        this.wrapChart();\n\n        this._crosshairCursor = {};\n        this._crosshairCursor.x = createCrosshairCursor(this._chartWrapper, 'x');\n        this._crosshairCursor.y = createCrosshairCursor(this._chartWrapper, 'y');\n        this.hide(this._crosshairCursor);\n\n        this._chartWrapper.addEventListener('click', clickFn.bind(this));\n        this._chartWrapper.addEventListener('mousemove', this.move.bind(this));\n        this._chartWrapper.addEventListener('mouseenter', this.show.bind(this));\n        this._chartWrapper.addEventListener('mouseleave', this.hide.bind(this));\n      };\n\n      CrosshairCursor.prototype.destroy = function() {\n        destroyCrosshairCursor(this._crosshairCursor);\n\n        unwrapChart(this._chartWrapper);\n      };\n\n      CrosshairCursor.prototype.show = function() {\n        showCrosshairCursor(this._crosshairCursor);\n      };\n\n      CrosshairCursor.prototype.hide = function() {\n        if(!this.frozen) {\n          hideCrosshairCursor(this._crosshairCursor);\n        }\n      };\n\n      CrosshairCursor.prototype.reset = function() {\n        this.frozen = false;\n        this.hide();\n      };\n\n      CrosshairCursor.prototype.move = function(e) {\n        if(!this.frozen){\n          var position = moveCrosshairCursor.call(this._chartWrapper, e, this._crosshairCursor);\n          var highlightedPoints = highlightCurrentPoints(position, this._pointArea);\n          sendMetaData.call(this, highlightedPoints);\n        }\n      };\n\n      CrosshairCursor.prototype.freeze = function() {\n        this.frozen = true;\n        freezeChange.call(this);\n      };\n\n      CrosshairCursor.prototype.unfreeze = function() {\n        this.frozen = false;\n        freezeChange.call(this);\n      };\n\n      CrosshairCursor.prototype.isFrozen = function() {\n        return this.frozen;\n      };\n\n      CrosshairCursor.prototype.currentPoints = function() {\n        return currentPoints();\n      };\n\n      CrosshairCursor.prototype.element = function() {\n        return this._chartWrapper;\n      };\n\n      sendMetaData = function(points) {\n        var meta = points.map(function(point) {\n          return point.meta;\n        });\n        options.hover(this, meta);\n        this._chart.eventEmitter.emit('crosshairCursor:hovered', meta);\n      };\n\n      freezeChange = function() {\n        options.freezeChange(this.frozen);\n        this._chart.eventEmitter.emit('crosshairCursor:frozen', this.frozen);\n      };\n\n      currentPoints = function() {\n        return dataPoints.filter(function(point) {\n          return point.current;\n        });\n      };\n\n      createCrosshairCursor = function(chartWrapper, type) {\n        var div = document.createElement('div');\n        div.className = 'crosshairCursor-' + type;\n        chartWrapper.insertBefore(div, chartWrapper.firstChild);\n        var crosshairCursor = chartWrapper.querySelector('.crosshairCursor-' + type);\n        crosshairCursor.style.position = 'absolute';\n\n        styleCrosshairCursor(crosshairCursor, type);\n\n        return crosshairCursor;\n      };\n\n      destroyCrosshairCursor = function(crosshairCursor) {\n        crosshairCursor.x.remove();\n        crosshairCursor.y.remove();\n      };\n\n      styleCrosshairCursor = function(crosshairCursor, type) {\n        var styles = options.styles[type];\n        Object.keys(styles).forEach(function(property) {\n          crosshairCursor.style[property] = styles[property];\n        });\n      };\n\n      var inPointArea = function(cursorPosition, pointPosition, padding) {\n        return (cursorPosition >= (pointPosition - padding) && cursorPosition <= (pointPosition + padding));\n      };\n\n      var formatPointData = function(point) {\n        var meta = Chartist.deserialize(point.meta);\n        meta.value = point.value;\n        meta.value.x = point.axisX.ticks[point.index];\n        return {\n          meta: meta,\n          position: {x: Math.round(point.x), y: Math.round(point.y)},\n          element: point.element\n        };\n      };\n\n      var toggleHighlight = function(point, highlight) {\n        if(highlight) {\n          point.element.addClass('crosshairCursor-highlight');\n        } else {\n          point.element.removeClass('crosshairCursor-highlight');\n        }\n      };\n\n      var cursorIsOnPoint = function(cursorPosition, pointPosition, padding) {\n        if(options.x && options.y) {\n          return inPointArea(cursorPosition.x, pointPosition.x, padding) || inPointArea(cursorPosition.y, pointPosition.y, padding);\n        } else if(options.x) {\n          return inPointArea(cursorPosition.x, pointPosition.x, padding);\n        } else if(options.y) {\n          return inPointArea(cursorPosition.y, pointPosition.y, padding);\n        }\n      };\n\n      unwrapChart = function(chartWrapper) {\n        chartWrapper.outerHTML = chartWrapper.innerHTML;\n      };\n\n      calculatePointArea = function() {\n        var ctPoints = document.querySelectorAll('.ct-point');\n        var pointWidth = window.getComputedStyle(ctPoints[0])['stroke-width'].replace('px', '');\n        return +pointWidth/2;\n      };\n\n      showCrosshairCursor = function(crosshairCursor){\n        if(options.x && options.y) {\n          crosshairCursor.x.style.display = '';\n          crosshairCursor.y.style.display = '';\n        } else if(options.x) {\n          crosshairCursor.x.style.display = '';\n        } else if(options.y) {\n          crosshairCursor.y.style.display = '';\n        }\n      };\n\n      moveCrosshairCursor = function(e, crosshairCursor){\n        var crosshairCursorPosition = {};\n\n        crosshairCursorPosition.x = e.pageX - this.offsetLeft;\n        crosshairCursorPosition.y = e.pageY - this.offsetTop;\n\n        crosshairCursor.x.style.left = crosshairCursorPosition.x + 'px';\n        crosshairCursor.y.style.top = crosshairCursorPosition.y + 'px';\n\n        return crosshairCursorPosition;\n      };\n\n      highlightCurrentPoints = function(crosshairCursorPosition, pointArea) {\n        return dataPoints.filter(function(point) {\n          var highlighted = cursorIsOnPoint(crosshairCursorPosition, point.position, pointArea);\n          toggleHighlight(point, highlighted);\n          point.current = highlighted;\n          return highlighted;\n        });\n      };\n\n      clickFn = function(e) {\n        e.stopPropagation();\n        var meta = currentPoints().map(function(point) {\n          return point.meta;\n        });\n        options.click(this, meta);\n        this._chart.eventEmitter.emit('crosshairCursor:click', meta);\n      };\n\n      hideCrosshairCursor = function(crosshairCursor){\n        crosshairCursor.x.style.display = 'none';\n        crosshairCursor.y.style.display = 'none';\n      };\n\n      return function crosshairCursor(chart) {\n        var created = false;\n\n        if(chart instanceof Chartist.Line) {\n\n          chart.on('draw', function(data) {\n            if(data.type === 'point') {\n              if(data.index === 0) { dataPoints = []; }\n              dataPoints.push(formatPointData(data));\n            }\n          });\n\n          chart.on('created', function() {\n            if(!created) {\n              created = true;\n              chart.crosshairCursor = new CrosshairCursor(chart);\n              chart.crosshairCursor.create();\n            } else {\n              chart.crosshairCursor.reset();\n            }\n          });\n\n        } else {\n          throw 'Chart must be an instance of Chartist.Line';\n        }\n\n      };\n    };\n\n\n  }(window, document, Chartist));\n  return Chartist.plugins.crosshairCursor;\n\n}));\n"]}